[iOS内存分配与分区](https://www.jianshu.com/p/7bbbe5d55440)

[](https://blog.csdn.net/youoran/article/details/10990815)

### 1.RAM ROM

- RAM：运行内存，不能掉电存储。

- ROM：存储性内存，可以掉电存储，例如内存卡、Flash。

  >  由于RAM类型不具备掉电存储能力（即一掉电数据消失），所以app程序一般存放于ROM中。RAM的访问速度要远高于ROM，价格也要高。

### 2.App程序启动

	App程序启动，系统会把开启的那个App程序从Flash或ROM里面拷贝到内存（RAM），然后从内存里面执行代码。

另一个原因是CPU不能直接从内存卡里面读取指令（需要Flash驱动等等).

### 3.内存分区

#### 栈区（stack）

- 存放的局部变量、先进后出、一旦出了作用域就会被销毁；函数跳转地址，现场保护等；
- 程序猿不需要管理栈区变量的内存；
- 栈区地址从高到低分配

#### 堆区（heap）：

- 堆区的内存分配使用的是alloc；
- 需要程序员管理内存；
- ARC的内存的管理，是编译器再编译的时候自动添加 retain、release、autorelease；
- 堆区的地址是从低到高分配）

#### 全局区／静态区（static）

- 包括两个部分：未初始化过 、初始化过；
  也就是说，（全局区／静态区）在内存中是放在一起的，初始化的全局变量和静态变量在一块区域， 未初始化的全局变量和未初始化的静态变量在相邻的另一块区域；
  eg：int a;未初始化的。int a = 10;已初始化的。

#### 常量区

- 常量字符串就是放在这里；

#### 代码区

- 存放App代码；

### 4.注意事项

- 在iOS中，堆区的内存是应用程序共享的，堆中的内存分配是系统负责的；

- 系统使用一个链表来维护所有已经分配的内存空间（系统仅仅纪录，并不管理具体的内容）；
- 变量使用结束后，需要释放内存，OC中是根据引用计数＝＝0，就说明没有任何变量使用该空间，那么系统将直接收回；
- 当一个app启动后，代码区，常量区，全局区大小已固定，因此指向这些区的指针不会产生崩溃性的错误。而堆区和栈区是时时刻刻变化的（堆的创建销毁，栈的弹入弹出），所以当使用一个指针指向这两个区里面的内存时，一定要注意内存是否已经被释放，否则会产生程序崩溃（也即是野指针报错）。